<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}CBT System{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        body {
            background-color: #f5f5f5;
        }
        .navbar-custom {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-custom navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">CBT System</a>
            <div class="d-flex">
                <a href="{{ url_for('start') }}" class="btn btn-outline-light btn-sm me-2">Start Exam</a>
                {% if session.get('username') %}
                <span class="navbar-text text-white me-3">{{ session.get('full_name', session.get('username')) }}</span>
                {% if session.get('role') == 'superadmin' %}
                <a href="/6869" class="btn btn-outline-light btn-sm me-2">6869</a>
                {% endif %}
                <a href="/logout" class="btn btn-outline-light btn-sm">Logout</a>
                {% else %}
                <a href="{{ url_for('login') }}" class="btn btn-outline-light btn-sm">Login</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
    // Eye icon toggle positioned at extreme right to avoid covering input text
    document.addEventListener('DOMContentLoaded', function () {
        function eyeSVG() { return '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>'; }
        function eyeOffSVG() { return '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.94 10.94 0 0 1 12 20c-7 0-11-8-11-8a21.42 21.42 0 0 1 5.06-6.94"></path><path d="M1 1l22 22"></path></svg>'; }

        document.querySelectorAll('input[type="password"]').forEach(function(input) {
            try {
                if (input.dataset.toggleAdded) return;
                var parent = input.parentElement || input.parentNode;
                if (parent) parent.style.position = parent.style.position || 'relative';
                var btn = document.createElement('button');
                btn.type = 'button';
                // minimal, transparent button to avoid visual clutter
                btn.className = 'btn btn-sm';
                btn.style.border = 'none';
                btn.style.background = 'transparent';
                btn.setAttribute('aria-label', 'Show password');
                btn.innerHTML = eyeSVG();
                btn.style.position = 'absolute';
                // place at extreme edge
                btn.style.right = '4px';
                btn.style.top = '50%';
                btn.style.transform = 'translateY(-50%)';
                btn.style.padding = '2px';
                btn.style.width = '28px';
                btn.style.height = '28px';
                btn.style.zIndex = 5;
                // light gray icon color
                btn.style.color = '#b0b0b0';
                // darken on hover for affordance
                btn.addEventListener('mouseenter', function(){ btn.style.color = '#666'; });
                btn.addEventListener('mouseleave', function(){ btn.style.color = '#b0b0b0'; });
                // reduce input padding so icon doesn't overlap content visually
                try { input.style.paddingRight = '36px'; } catch (e) {}
                btn.addEventListener('click', function () {
                    if (input.type === 'password') {
                        input.type = 'text';
                        btn.innerHTML = eyeOffSVG();
                        btn.setAttribute('aria-label', 'Hide password');
                    } else {
                        input.type = 'password';
                        btn.innerHTML = eyeSVG();
                        btn.setAttribute('aria-label', 'Show password');
                    }
                });
                parent.appendChild(btn);
                input.dataset.toggleAdded = '1';
            } catch (e) {
                console.warn('password toggle error', e);
            }
        });
    });
    </script>
    {% block scripts %}{% endblock %}
</body>
</html>